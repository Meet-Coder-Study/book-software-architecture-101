## 컴포넌트
- 물리적으로 패키징 한 것
- 아키텍처에서 서브시스템이나 레이어형태로 나타남
- 배포 가능한 작업 단위

## 아키텍트 역할
- 컴포넌트를 정의, 개선, 관리, 통제하는 일
- 클래스 설계 참여해서는 안되고, 상세설계에 관여해서도 안 됨 => 부서 사람들이 중요한 결정을 할 수 있는 자율권을 주어야 함
- 소프트웨어는 만사가 **트레이드 오프**
- 최상위 아키텍처를 분할하는 2가지 방법
  - 기술 분할
  - 도메인 분할
- *시스템을 설계하는 조직은 소통 구조를 구대로 옮겨 놓은 듯한 설계도를 그릴 수 밖에 없다*
- 피드백을 통해 다듬고 세분화하는 과정이 필요
- 적당한 세분도를 찾는 것은 어려운 작업 중 하나

### 기술 분할
- 레이어드 아키텍처
- 기술적 측면에서 분할
- MVC 패턴과 잘 맞음
- 프레젠테이션, 비즈니스 규칙 서비스, 퍼시스턴스 등으로 분할
- 각 역할을 부여하는 방식
- 기술 관심사의 분리 => 유용한 수준의 디커플링
- 장점
  - 커스텀 코드가 명확하게 분리
  - 레이어드 아키텍처 패턴에 가까움
- 단점
  - 커플링이 더 높음 => 하나의 컴포넌트의 변경이 다른 컴포넌트에 영향을 줄 수 있음
  - 넘나드는 워크플로
  - 분산 시스템으로 옮기기 어려움

### 도메인 분할
- 모듈러 모놀리스
- 도메인에 따라 분할된 단일 배포 단위
- DDD, 마이크로 아키텍처의 근본 사상
- 분리된 도메인 또는 워크플로로 식별
- 장점
  - 비즈니스 기능에 가깝게 모델링
  - 도메인별 다목적팀 구성하기 쉬움
  - 모듈러 모놀리스와 마이크로서비스 아키텍처 스타일에 가까움
  - 메세지 흐름이 문제 영역과 일치
  - 분산 아키텍처로 옮기기 쉬움
- 단점
  - 유저 정의 코드가 분산됨

## 컴포넌트 설계
- 초기 설계: 여러 아키텍처 특성을 고려하여 문제 영역을 큰 덩어리로 나누는 것

### 엔티티 함정
- 데이터베이스 관계를 애플리케이션의 워크플로로 오해할 때 발생
- 컴포넌트가 크게 나누어져 컴포넌트의 역할을 하기 어려움

### 액터/액션 접근법
- 요구사항을 컴포넌트에 매핑할 때 흔히 사용
- 일을 하는 액터, 수행하는 액션으로 구분
- 유저, 일
- 모놀리식, 분산시스템을 비롯한 모든 시스템에 통용
- 폭포수 시스템에서 선호하는 편?!

### 이벤트 스토밍
- DDD에서 사용되는 컴포넌트 발견 기법
- 다양한 컴포넌트가 메시지(api?!), 이벤트로 통신한다고 가정
- 컴포넌트를 이벤트와 메시지 핸들러 중심으로 구축 
- 마이크로서비스

### 워크플로 접근법
- 이벤트 스토밍의 대안
- 핵심 역할을 식별하고 관여하는 워크플로 유형을 결정하여 컴포넌트를 구축

## 사례
- BidCapture 컴포넌트가 입찰자, 경매인 양쪽의 입찰을 캡처
- 기능은 동일하나 입찰자와 경매인의 아키텍처 특성이 다를 수 있음
  - 입찰자: 수천명 단위로 증가 가능할 수 있는 확장성, 탄력성이 필요
  - 경매인: 인원이 한정적인 편으로 확장성, 탄력성은 필요 없음. 신뢰성과 가용성이 더 필요함
- BidCapture => BidCapture, AuctioneerCapture 로 나누어 다른 수준의 아키텍처 특성을 지원해야 함
- 모든 특성을 만족시킬 수는 없으므로 어떤 아키텍처 특성이 더 주요하게 작용할 것인지 판단하여 트레이트 오프 조합을 따져봐야 함

## 정리
- 모놀리식 아키텍처
  - 보통 배포 단위가 하나
  - 단일 퀀텀(한 세트의 아키텍처 특성)일 때, 모놀리식 아키텍처가 장점이 더 많을 것
- 분산 아키텍처
  - 네트워킹 프로토콜을 통해 통신하는 여러 서비스로 구성
  - 읽기 전용, 대용량 업데이트 등과 분리할 수도 있음 (CQRS를 의미하는 듯!?)
  - 서로 다른 아키텍처 특성이 혼재되기 때문에 분산 아키텍처를 선택
- 아키텍처 퀀텀: 아키텍처의 다른 파트와 독립적으로 작동되는 모든 컴포넌트를 포함 (예시: DB는 퀀텀의 일부)(7장 내용을 참고) 
- 아키텍처 퀀텀을 활용하여 근본적인 설계 특성을 결정하고 범위와 커플링을 분석할 수 있음 

# 의견
- 데이터베이스 관점에서 컴포넌트를 나눈다면 컴포넌트 단위가 커져 유의미하지 않을 수 있음
  - 사용자 유스케이스의 측면에서 컴포넌트를 나눠야 할 것
  - DB관점과 도메인 특성을 분리해서 볼 수 있어야 할 듯 싶다
- 기능이 복잡해지는 애플리케이션에서는 레이어드 아키턱처는 의존관계의 영향이 복잡해질 수 있고, 특성이 다르므로 분산시스템으로 나아가는 듯 함
  - 9장의 마이크로서비스에서 주의해야할 특성들을 참고하여 분산시스템을 적용할 것인지 결정해야 할 듯
- 각 컴포넌트가 가지는 특성에 따라 아키텍처 특성을 추출하고 그 특성을 살릴 수 있는 아키텍처를 구성해야 한다.
  - CAP
  - 트레이트 오프가 생기므로 모든 것을 만족시킬 수는 없음
  - 마지막 예시로 보여주는 것이 특성에 따라 CQRS로 분리하는 것을 의미한다고 생각했다.
  - Read 작업과 Command 특성이 다르므로 그것을 분리하여 컴포넌트를 나누고 분산시스템을 구축할 수 있을 듯 싶다.
  - 같은 기능을 하는 것이라도 특성에 따라 가용성, 확장성 등 중요하게 필요한 특성이 다르므로 다르게 컴포넌트를 가져가는 것이 좋을 수 있다.
